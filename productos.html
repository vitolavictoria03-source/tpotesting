<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Listado de Productos</title>
</head>
<body>
  <header>
    <h1>Productos</h1>
    <div id="saludo"></div>
  </header>
  <div class="wrap">
    <div class="toolbar">
      <input id="q" placeholder="Buscar por nombre...">
      <select id="cat"><option value="">Todas</option></select>
      <select id="sort">
        <option value="price-asc">Precio ↑</option>
        <option value="price-desc">Precio ↓</option>
      </select>
      <select id="pp">
        <option value="5">5 por página</option>
        <option value="10" selected>10</option>
        <option value="20">20</option>
      </select>
    </div>

    <table id="grid"><thead>
      <tr><th>Nombre</th><th>Categoría</th><th>Precio</th></tr>
    </thead><tbody></tbody></table>

    <div id="empty" class="empty" style="display:none">No se encontraron resultados.</div>

    <div class="pager">
      <button class="btn" id="prev">⟵ Anterior</button>
      <span class="badge" id="info">Página 1/1</span>
      <button class="btn" id="next">Siguiente ⟶</button>
    </div>
    <p><a href="index.html">← Volver al registro</a></p>
  </div>

  <script>
    const DATA=[{name:'Auriculares',category:'Audio',price:29999},{name:'Teclado',category:'Periféricos',price:45999},{name:'Mouse',category:'Periféricos',price:24999}];
    const $=s=>document.querySelector(s), tbody=$('#grid tbody'), q=$('#q'),cat=$('#cat'),sort=$('#sort'),pp=$('#pp');
    const prev=$('#prev'),next=$('#next'),info=$('#info'),empty=$('#empty');
    const user=JSON.parse(localStorage.getItem('usuario')||'null');if(user)$('#saludo').textContent=`Hola, ${user.nombre}`;
    let state={page:1,perPage:+pp.value,query:'',category:'',sort:'price-asc'};
    [...new Set(DATA.map(d=>d.category))].forEach(c=>{let o=document.createElement('option');o.value=c;o.textContent=c;cat.appendChild(o);});
    q.addEventListener('input',()=>{state.query=q.value.toLowerCase();state.page=1;render();});
    cat.addEventListener('change',()=>{state.category=cat.value;state.page=1;render();});
    sort.addEventListener('change',()=>{state.sort=sort.value;render();});
    pp.addEventListener('change',()=>{state.perPage=+pp.value;state.page=1;render();});
    prev.addEventListener('click',()=>{if(state.page>1){state.page--;render();}});
    next.addEventListener('click',()=>{if(state.page<totalPages()){state.page++;render();}});
    function applyFilters(data){let out=data;if(state.query)out=out.filter(x=>x.name.toLowerCase().includes(state.query));if(state.category)out=out.filter(x=>x.category===state.category);
      return out.slice().sort((a,b)=>state.sort==='price-asc'?a.price-b.price:b.price-a.price);}
    function totalPages(){return Math.max(1,Math.ceil(applyFilters(DATA).length/state.perPage));}
    function paged(d){const s=(state.page-1)*state.perPage;return d.slice(s,s+state.perPage);}
    function money(n){return n.toLocaleString('es-AR',{style:'currency',currency:'ARS'});}
    function render(){const f=applyFilters(DATA),items=paged(f);tbody.innerHTML='';items.forEach(r=>{const tr=document.createElement('tr');tr.innerHTML=`<td>${r.name}</td><td>${r.category}</td><td>${money(r.price)}</td>`;tbody.appendChild(tr);});
      const tp=totalPages();info.textContent=`Página ${state.page}/${tp}`;prev.disabled=state.page===1;next.disabled=state.page===tp;empty.style.display=f.length?'none':'block';}
    render();
  </script>
</body>
</html>