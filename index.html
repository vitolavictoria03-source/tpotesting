<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Registro de Usuario</title>
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
  <link rel="stylesheet" href="Estilo.css">
</head>
<body class="center">
  <main class="card">
    <h1>Registro</h1>
    <p>Completa los datos para regirstrarse</p>

    <form id="form-registro" novalidate>
      <label for="nombre">Nombre:</label>
      <input id="nombre" required placeholder="Ej: Ana Pérez" class ="input">

      <label for="email">Email: </label>
      <input id="email" type="email" required placeholder="ana@email.com">

      <div class="field">
        <label for="password">Contraseña</label>
        <input id="password" type="password" placeholder="Ingresá tu contraseña" />
        <button type="button" id="togglePwd" aria-label="Mostrar/Ocultar contraseña">
          <i class="bi bi-eye"></i>
        </button>
      </div>

     <div class="actions">
        <button class="btn primary" type="submit">Registrarme</button>
        <a href="Login.html">¿Ya tienes usuario?</a>
      </div>
      <div id="msg" class="msg" style="display:none"></div>
    </form>

<!-- POPUP: Éxito -->
    <div id="overlay" class="overlay" role="dialog" aria-modal="true" aria-labelledby="popupTitle">
      <div class="popup">
        <h2 id="popupTitle">✅ Registro exitoso</h2>
        <p>Tu cuenta se creó correctamente</p>
        <button class="btn" id="closeBtn">Siguiente</button>
      </div>
    </div>

    <!-- POPUP: Campos vacíos -->
    <div id="pop-empty" class="overlay" role="dialog" aria-modal="true" aria-labelledby="emptyTitle">
      <div class="popup">
        <h2 id="emptyTitle">⚠️Campos vacíos</h2>
        <p>Completá <strong>nombre, email y contraseña</strong> para continuar.</p>
        <button class="btn" data-close="pop-empty">Entendido</button>
      </div>
    </div>

    <!-- POPUP: Faltan datos / inválidos -->
    <div id="pop-missing" class="overlay" role="dialog" aria-modal="true" aria-labelledby="missingTitle">
      <div class="popup">
        <h2 id="missingTitle">⚠️ Faltan datos válidos</h2>
        <p>Revisá lo siguiente:</p>
        <ul id="missing-list"></ul>
        <button class="btn" data-close="pop-missing">Corregir</button>
      </div>
    </div>

    <footer class="site-footer">
      <div class="footer-wrap">
        <p class="footer-eyebrow">Conoce más sobre</p>
        
        <img src="logofooter.png" alt="Logo EneBar" class="footer-logo" >

        <ul class="footer-links">
          <li><a href="#">¿Quienes somos?</a></li>
          <li><a href="#">¿Dónde encontrarnos?</a></li>
          <li><a href="productos.html">Nuestras Barritas</a></li>
          <li><a href="#">Contactanos</a></li>
          <li><a href="#">Nuestras Redes</a></li>
        </ul>

        <div class="footer-icons">
          <a href="https://instagram.com" aria-label="Instagram" target="_blank" rel="noopener">
            <i class="bi bi-instagram" style="font-size:1.3rem;"></i>
          </a>
          <a href="https://twitter.com" aria-label="Twitter" target="_blank" rel="noopener">
            <i class="bi bi-twitter" style="font-size:1.3rem;"></i>
          </a>
          <a href="mailto:contacto@enebar.com" aria-label="Email">
            <i class="bi bi-envelope" style="font-size:1.3rem;"></i>
          </a>
        </div>
      </div>
    </footer>
  </main>

  <script>
    const $ = s => document.querySelector(s);
    const nombre = $('#nombre'), email = $('#email'), pass = $('#password'), msg = $('#msg');
    const form = $('#form-registro');

    // Validación de Email
    const reEmail = /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/;
    // Validación de contraseña (1 minúscula, 1 mayúscula, 1 número, mín. 5)
    const rePwd = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{5,}$/;

    // Mostrar/ocultar contraseña con icono de Bootstrap
    const toggle = $('#togglePwd');
    const icon = toggle.querySelector('i');
    toggle.addEventListener('click', () => {
      const show = pass.type === 'password';
      pass.type = show ? 'text' : 'password';
      icon.classList.toggle('bi-eye', !show);
      icon.classList.toggle('bi-eye-slash', show);
    });

    // Helpers popups
    function openPopup(id){ document.getElementById(id).style.display = 'flex'; }
    function closePopup(id){ document.getElementById(id).style.display = 'none'; }
    document.querySelectorAll('[data-close]').forEach(b=>b.addEventListener('click',()=>closePopup(b.getAttribute('data-close'))));

    // Validaciones rápidas
    function setState(input, ok){ input.classList.toggle('ok', ok); input.classList.toggle('err', !ok); return ok; }
    const vNombre = () => setState(nombre, nombre.value.trim().length >= 2);
    const vEmail  = () => setState(email,  reEmail.test(email.value.trim()));
    const vPwd    = () => setState(pass,   rePwd.test(pass.value.trim()));
    [nombre, email, pass].forEach(i => i.addEventListener('input', () => {
      if(i===nombre) vNombre(); if(i===email) vEmail(); if(i===pass) vPwd();
    }));

    // Submit → popups según el caso
    const overlay = $('#overlay');      // éxito
    const closeBtn = $('#closeBtn');    // botón éxito

    form.addEventListener('submit', (e) => {
      e.preventDefault();
      msg.style.display = 'none';

      const n = nombre.value.trim();
      const m = email.value.trim();
      const p = pass.value.trim();

      // 1) Todos vacíos
      if (!n && !m && !p) { openPopup('pop-empty'); return; }

      // 2) Faltantes/incorrectos
      const faltantes = [];
      if (n.length < 2) faltantes.push('• Nombre: mínimo 2 caracteres.');
      if (!reEmail.test(m)) faltantes.push('• Email con formato válido (usuario@dominio).');
      if (!rePwd.test(p))  faltantes.push('• Contraseña: 1 mayúscula, 1 minúscula, 1 número y mínimo 5 caracteres.');

      if (faltantes.length > 0) {
        $('#missing-list').innerHTML = faltantes.map(x => `<li>${x}</li>`).join('');
        openPopup('pop-missing');
        return;
      }

      // 3) Todo OK → guardar y éxito
      localStorage.setItem('usuario', JSON.stringify({ nombre: n, email: m }));
      overlay.style.display = 'flex';
    });

    // Cerrar popup de éxito → continuar
    closeBtn.addEventListener('click', () => {
      overlay.style.display = 'none';
      // Redirige si querés:
      window.location.href = 'productos.html';
    });

    // Cerrar popups haciendo clic fuera
    ['overlay','pop-empty','pop-missing'].forEach(id=>{
      const el = document.getElementById(id);
      el.addEventListener('click', e => { if(e.target === el) el.style.display = 'none'; });
    });
  </script>
</body>
</html>
